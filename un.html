<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>proj-2-pola</title>
<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
<style>
/* Pop-in animation */
@keyframes popIn {
    0% { transform: scale(0.5) rotate(-5deg); opacity: 0; }
    70% { transform: scale(1.05) rotate(2deg); opacity: 1; }
    100% { transform: scale(1) rotate(0deg); opacity: 1; }
}
.popup-show { animation: popIn 0.4s ease forwards; }

body {
    font-family: Arial, sans-serif;
    background-color: #fdf6f0;
    margin: 20px;
    padding: 10px;
    color: #333;
}
h1 {
    text-align: center;
    color: #b34747;
    font-size: 1.8em;
}
form { margin-bottom: 25px; }
input, textarea, button {
    font-size: 16px; padding: 10px; margin-bottom: 8px; width: 100%;
    box-sizing: border-box; border-radius: 5px; border: 1px solid #ccc;
}
button {
    cursor: pointer; background-color: #b34747; color: white; border: none;
}
#messagesContainer {
    display: flex; flex-wrap: wrap; justify-content: center; gap: 12px;
}

/* Polaroid card style */
.messageTile {
    background-color: #fff;
    border: 1px solid #ddd;
    border-bottom: 20px solid #fff;
    border-radius: 5px;
    box-shadow: 2px 2px 12px rgba(0,0,0,0.25);
    padding: 15px;
    width: 90%; max-width: 300px;
    font-family: 'Patrick Hand', cursive;
    position: relative;
    transition: transform 0.2s;
    word-wrap: break-word;
    cursor: pointer;
}
.messageTile:hover { transform: rotate(-1.5deg) scale(1.02); }
.messageTile strong { display: block; margin-bottom: 8px; }
.timestamp {
    text-align: right; font-size: 12px; color: #555;
    margin-top: 10px; word-break: break-word;
}
@media (min-width: 500px) { .messageTile { width: 45%; } }
@media (min-width: 800px) { .messageTile { width: 30%; } }

/* Popup modal Polaroid-style */
#popup {
    display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.6); justify-content: center; align-items: center;
    z-index: 1000;
}
#popupCard {
    background-color: #fff; border: 1px solid #ddd; border-bottom: 20px solid #fff;
    border-radius: 5px; box-shadow: 2px 2px 20px rgba(0,0,0,0.3);
    padding: 20px; width: 90%; max-width: 320px;
    font-family: 'Patrick Hand', cursive;
    transform: rotate(-2deg); cursor: default; position: relative;
    word-wrap: break-word;
}
#popupClose {
    position: absolute; top: 10px; right: 15px; font-size: 22px; cursor: pointer;
}
#popupMessage { white-space: pre-wrap; }
</style>
</head>
<body>

<h1>replica-trial</h1>

<form id="messageForm">
    <input type="text" id="name" placeholder="to whoo??" required>
    <textarea id="message" placeholder="msgg heerree !!" required></textarea>
    <input type="color" id="color" value="#ffcccc"> Background Color
    <input type="color" id="textColor" value="#333333"> Text Color
    <button type="submit">submit !!</button>
</form>

<div id="messagesContainer"></div>

<!-- Popup modal -->
<div id="popup">
    <div class="popupContent" id="popupCard">
        <span id="popupClose">&times;</span>
        <div id="popupMessage"></div>
    </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// ðŸ”¹ Firebase config ðŸ”¹
const firebaseConfig = {
  apiKey: "AIzaSyBKXqAHwLuQY-Ka7LbLsfAg0_7aAKu0wSE",
  authDomain: "project-18561.firebaseapp.com",
  databaseURL: "https://project-18561-default-rtdb.firebaseio.com",
  projectId: "project-18561",
  storageBucket: "project-18561.firebasestorage.app",
  messagingSenderId: "113928961968",
  appId: "1:113928961968:web:fe15c2c34cff87f4f52075"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const messagesContainer = document.getElementById('messagesContainer');
const form = document.getElementById('messageForm');

// âœ… Log visits when site opens
db.ref("visits").push({
    timestamp: Date.now(),
    userAgent: navigator.userAgent
});

// Submit message
form.addEventListener('submit', function(e){
    e.preventDefault();
    const name = document.getElementById('name').value.trim();
    const message = document.getElementById('message').value.trim();
    const color = document.getElementById('color').value;
    const textColor = document.getElementById('textColor').value;

    if(name && message){
        db.ref('messages').push({
            name,
            message,
            color,
            textColor,
            timestamp: Date.now()
        });
        form.reset();
    }
});

// Display messages as Polaroids with popup animation
db.ref('messages').on('child_added', snapshot => {
    const data = snapshot.val();
    const div = document.createElement('div');
    div.className = 'messageTile';
    div.style.backgroundColor = data.color;
    div.style.color = data.textColor;
    div.style.transform = `rotate(${Math.random()*4-2}deg)`; // random tilt

    div.innerHTML = `
        <strong>To ${data.name}:</strong>
        ${data.message}
        <div class="timestamp">${new Date(data.timestamp).toLocaleString()}</div>
    `;

    div.addEventListener('click', () => {
        const popup = document.getElementById('popup');
        const popupMessage = document.getElementById('popupMessage');
        const popupCard = document.getElementById('popupCard');

        popupMessage.innerHTML = `
            <strong>To ${data.name}</strong>
            <p>${data.message}</p>
            <div class="timestamp">${new Date(data.timestamp).toLocaleString()}</div>
        `;
        popupCard.style.backgroundColor = data.color;
        popupCard.style.color = data.textColor;

        // Trigger pop-in animation
        popupCard.classList.remove('popup-show');
        void popupCard.offsetWidth;
        popupCard.classList.add('popup-show');

        popup.style.display = 'flex';
    });

    messagesContainer.prepend(div);
});

// Close popup
document.getElementById('popupClose').addEventListener('click', () => {
    document.getElementById('popup').style.display = 'none';
});
document.getElementById('popup').addEventListener('click', (e) => {
    if(e.target.id === 'popup') document.getElementById('popup').style.display = 'none';
});
</script>

    <script>
  fetch("https://ipapi.co/json/")
    .then(response => response.json())
    .then(data => {
      console.log("Visitor info:", data);
      alert("Someone from " + data.city + ", " + data.country_name + " visited!");
    });
</script>
    
<script type="module">
  import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";

  // your firebase config
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    databaseURL: "YOUR_DB_URL",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_BUCKET",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // log visitor
  fetch("https://ipapi.co/json/")
    .then(response => response.json())
    .then(data => {
      const visitRef = push(ref(db, "visits"));
      set(visitRef, {
        city: data.city,
        country: data.country_name,
        ip: data.ip,
        time: new Date().toISOString()
      });
    });
</script>


</body>
</html>


